package com.sdase.malwarescanner.strategy.impl;

import com.sdase.malwarescanner.entity.Check;
import com.sdase.malwarescanner.entity.File;
import com.sdase.malwarescanner.service.CheckService;
import com.sdase.malwarescanner.service.FileProducerService;
import com.sdase.malwarescanner.service.FileService;
import org.springframework.stereotype.Component;

@Component
public class ErrorStrategy extends SuspiciousStrategy {

    public ErrorStrategy(CheckService checkService, FileService fileService, FileProducerService fileProducerService) {
        super(checkService, fileService, fileProducerService);
    }

    @Override
    public void updateCheck(Check check) {
        check.setState(Check.State.ERROR);
        checkService.addOrEdit(check);
    }

    @Override
    public void updateFile(File file) {
        file.setState(File.State.ERROR);
        fileService.addOrEdit(file);
    }

    @Override
    public CheckResultEventStrategyFactory.StrategyName getStrategyName() {
        return CheckResultEventStrategyFactory.StrategyName.ERROR_STRATEGY;
    }

}
